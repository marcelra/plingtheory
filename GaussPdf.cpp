#include "GaussPdf.h"

#include <cassert>
#include <cmath>

namespace Math
{

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// constructor
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
GaussPdf::GaussPdf( double mu, double sigma ) :
   m_mu( mu ),
   m_sigma( sigma ),
   m_gaussArgFac( -0.5 / ( sigma * sigma ) ),
   m_erfArgFac( 1.0 / ( sqrt( 2.0 ) * sigma ) ),
   m_norm(  1 / sqrt( 2 * M_PI ) / sigma )
{}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// getDensity
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
double GaussPdf::getDensity( double x ) const
{
   double arg = ( x - m_mu );
   return m_norm * exp( m_gaussArgFac * arg * arg );
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// getProbability
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
double GaussPdf::getProbability( double x0, double x1 ) const
{
   assert( x1 > x0 );
   return ( getIntegral( x1 ) - getIntegral( x0 ) );
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// getIntegral
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
double GaussPdf::getIntegral( double x ) const
{
   return 0.5 + 0.5 * erf( ( x - m_mu ) * m_erfArgFac );
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// getMu
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
double GaussPdf::getMu() const
{
   return m_mu;
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// getSigma
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
double GaussPdf::getSigma() const
{
   return m_sigma;
}

} /// namespace Math
