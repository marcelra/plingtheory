#include "AdvancedFourierSpectrum.h"

#include "AdvancedFourierTransform.h"

namespace WaveAnalysis
{

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// constructor
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
AdvancedFourierSpectrum::AdvancedFourierSpectrum( const AdvancedFourierTransform& transform, const Complex* first, const Complex* last ) :
   ComplexVector( first, last ),
   m_transform( transform )
{}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// getMagnitudeInBin
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
double AdvancedFourierSpectrum::getMagnitudeInBin( size_t binIndex ) const
{
   return abs( (*this)[binIndex] );
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// getPhaseInBin
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
double AdvancedFourierSpectrum::getPhaseInBin( size_t binIndex ) const
{
   return arg( (*this)[binIndex] );
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// getMagnitude
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
RealVector AdvancedFourierSpectrum::getMagnitude() const
{
   RealVector result( size() );
   for ( size_t i = 0; i < size(); ++i )
   {
      result[i] = abs( (*this)[i] );
   }
   return result;
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// getPhase
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
RealVector AdvancedFourierSpectrum::getPhase() const
{
   RealVector result( size() );
   for ( size_t i = 0; i < size(); ++i )
   {
      result[i] = arg( (*this)[i] );
   }
   return result;
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// getSamplingInfo
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
const SamplingInfo& AdvancedFourierSpectrum::getSamplingInfo() const
{
   return m_transform.getSamplingInfo();
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// getFrequencyOfin
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
double AdvancedFourierSpectrum::getFrequencyOfBin( size_t binIndex ) const
{
   return m_transform.getSpectrumFrequencies()[binIndex];
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// getFrequencies
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
const RealVector& AdvancedFourierSpectrum::getFrequencies() const
{
   return m_transform.getSpectrumFrequencies();
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// getFrequency
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
double AdvancedFourierSpectrum::getFrequency( double x ) const
{
   return m_transform.getLowestFrequency() * x;
}

} /// namespace WaveAnalysis
